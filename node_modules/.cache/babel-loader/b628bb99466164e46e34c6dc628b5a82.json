{"ast":null,"code":"var _jsxFileName = \"/Users/kokiyamamoto/Desktop/projects/FoodsMap/src/components/gmap.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport { appSlice } from '../redux/appSlice';\nimport { mapSlice } from '../redux/mapSlice';\nimport { useSelector, useDispatch } from 'react-redux';\nimport './gmap.css';\nimport { initMap, initService } from './mapapi';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet map, service;\nlet shouldMapInitialize = true;\nlet userLocation = {\n  lat: 35.41221,\n  lng: 139.4130\n};\nconst radius = 1000;\nexport const getMapObject = () => {\n  return map;\n};\nexport const getCenter = () => {\n  let latlng = map.getCenter();\n  return latlng;\n};\nexport const getServiceObject = () => {\n  return service;\n};\nexport const getUserLocation = () => {\n  return userLocation;\n};\nconst getUserLocationPromise = new Promise((resolve, reject) => {\n  navigator.geolocation.getCurrentPosition(resolve, reject);\n});\n\nfunction GMap(props) {\n  _s();\n\n  let dispatch = useDispatch();\n  const isUserLocRequested = useSelector(state => state.mapSlice.isUserLocRequested);\n  useEffect(() => {\n    if (isUserLocRequested) {\n      let prm = getUserLocationPromise.then(function (value) {\n        userLocation = {\n          lat: value.coords.latitude,\n          lng: value.coords.longitude\n        };\n        map.panTo(userLocation);\n      }).catch(value => {\n        console.log(\"unable to obtain the user position\");\n      }).finally(() => {\n        dispatch(mapSlice.actions.requestUserLoc(false));\n      });\n    }\n\n    if (shouldMapInitialize) {\n      map = initMap(document.getElementById('map'), userLocation);\n      service = initService(map);\n      shouldMapInitialize = false;\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {},\n      id: \"map\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 9\n  }, this);\n}\n\n_s(GMap, \"WHV8H0K4yWrZ3Qh2gM8xUp/kqrA=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = GMap;\nexport default GMap;\n\nvar _c;\n\n$RefreshReg$(_c, \"GMap\");","map":{"version":3,"names":["React","useEffect","appSlice","mapSlice","useSelector","useDispatch","initMap","initService","map","service","shouldMapInitialize","userLocation","lat","lng","radius","getMapObject","getCenter","latlng","getServiceObject","getUserLocation","getUserLocationPromise","Promise","resolve","reject","navigator","geolocation","getCurrentPosition","GMap","props","dispatch","isUserLocRequested","state","prm","then","value","coords","latitude","longitude","panTo","catch","console","log","finally","actions","requestUserLoc","document","getElementById"],"sources":["/Users/kokiyamamoto/Desktop/projects/FoodsMap/src/components/gmap.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { appSlice } from '../redux/appSlice';\nimport { mapSlice } from '../redux/mapSlice';\nimport { useSelector, useDispatch } from 'react-redux';\nimport './gmap.css';\nimport { initMap, initService} from './mapapi'\n\n\n\nlet map, service;\nlet shouldMapInitialize = true;\nlet userLocation = {\n    lat: 35.41221,\n    lng: 139.4130\n};\n\nconst radius = 1000;\n\nexport const getMapObject = () => {\n\n    return map;\n\n}\n\nexport const getCenter = () => {\n    let latlng = map.getCenter();\n   \n    return latlng;\n}\n\n\nexport const getServiceObject = () => {\n\n    return service;\n\n}\n\nexport const getUserLocation = () => {\n    \n    return userLocation;\n}\n\n\nconst getUserLocationPromise = new Promise((resolve, reject) => {\n    navigator.geolocation.getCurrentPosition(resolve, reject)\n})\n\n\n\n\nfunction GMap(props) {\n\n    let dispatch = useDispatch();\n\n    const isUserLocRequested = useSelector(state => state.mapSlice.isUserLocRequested);\n\n    useEffect(() => {\n\n        if (isUserLocRequested) {\n            let prm = getUserLocationPromise.then(function (value) {\n\n                userLocation = {\n                    lat: value.coords.latitude,\n                    lng: value.coords.longitude\n                };\n            \n                map.panTo(userLocation);\n\n\n            }).catch(value => {\n\n                console.log(\"unable to obtain the user position\")\n\n            }).finally(() => {\n\n                dispatch(mapSlice.actions.requestUserLoc(false));\n\n\n            });\n\n\n        }\n\n        if (shouldMapInitialize) {\n            map = initMap(document.getElementById('map'), userLocation);\n            service = initService(map);\n            shouldMapInitialize = false;\n        }\n    })\n\n\n\n    return (\n        <div>\n            <div style={{}} id='map'></div>\n        </div>\n    )\n}\n\n\n\n\n\n\nexport default GMap;\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,QAAT,QAAyB,mBAAzB;AACA,SAASC,QAAT,QAAyB,mBAAzB;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,OAAO,YAAP;AACA,SAASC,OAAT,EAAkBC,WAAlB,QAAoC,UAApC;;AAIA,IAAIC,GAAJ,EAASC,OAAT;AACA,IAAIC,mBAAmB,GAAG,IAA1B;AACA,IAAIC,YAAY,GAAG;EACfC,GAAG,EAAE,QADU;EAEfC,GAAG,EAAE;AAFU,CAAnB;AAKA,MAAMC,MAAM,GAAG,IAAf;AAEA,OAAO,MAAMC,YAAY,GAAG,MAAM;EAE9B,OAAOP,GAAP;AAEH,CAJM;AAMP,OAAO,MAAMQ,SAAS,GAAG,MAAM;EAC3B,IAAIC,MAAM,GAAGT,GAAG,CAACQ,SAAJ,EAAb;EAEA,OAAOC,MAAP;AACH,CAJM;AAOP,OAAO,MAAMC,gBAAgB,GAAG,MAAM;EAElC,OAAOT,OAAP;AAEH,CAJM;AAMP,OAAO,MAAMU,eAAe,GAAG,MAAM;EAEjC,OAAOR,YAAP;AACH,CAHM;AAMP,MAAMS,sBAAsB,GAAG,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;EAC5DC,SAAS,CAACC,WAAV,CAAsBC,kBAAtB,CAAyCJ,OAAzC,EAAkDC,MAAlD;AACH,CAF8B,CAA/B;;AAOA,SAASI,IAAT,CAAcC,KAAd,EAAqB;EAAA;;EAEjB,IAAIC,QAAQ,GAAGxB,WAAW,EAA1B;EAEA,MAAMyB,kBAAkB,GAAG1B,WAAW,CAAC2B,KAAK,IAAIA,KAAK,CAAC5B,QAAN,CAAe2B,kBAAzB,CAAtC;EAEA7B,SAAS,CAAC,MAAM;IAEZ,IAAI6B,kBAAJ,EAAwB;MACpB,IAAIE,GAAG,GAAGZ,sBAAsB,CAACa,IAAvB,CAA4B,UAAUC,KAAV,EAAiB;QAEnDvB,YAAY,GAAG;UACXC,GAAG,EAAEsB,KAAK,CAACC,MAAN,CAAaC,QADP;UAEXvB,GAAG,EAAEqB,KAAK,CAACC,MAAN,CAAaE;QAFP,CAAf;QAKA7B,GAAG,CAAC8B,KAAJ,CAAU3B,YAAV;MAGH,CAVS,EAUP4B,KAVO,CAUDL,KAAK,IAAI;QAEdM,OAAO,CAACC,GAAR,CAAY,oCAAZ;MAEH,CAdS,EAcPC,OAdO,CAcC,MAAM;QAEbb,QAAQ,CAAC1B,QAAQ,CAACwC,OAAT,CAAiBC,cAAjB,CAAgC,KAAhC,CAAD,CAAR;MAGH,CAnBS,CAAV;IAsBH;;IAED,IAAIlC,mBAAJ,EAAyB;MACrBF,GAAG,GAAGF,OAAO,CAACuC,QAAQ,CAACC,cAAT,CAAwB,KAAxB,CAAD,EAAiCnC,YAAjC,CAAb;MACAF,OAAO,GAAGF,WAAW,CAACC,GAAD,CAArB;MACAE,mBAAmB,GAAG,KAAtB;IACH;EACJ,CAhCQ,CAAT;EAoCA,oBACI;IAAA,uBACI;MAAK,KAAK,EAAE,EAAZ;MAAgB,EAAE,EAAC;IAAnB;MAAA;MAAA;MAAA;IAAA;EADJ;IAAA;IAAA;IAAA;EAAA,QADJ;AAKH;;GA/CQiB,I;UAEUtB,W,EAEYD,W;;;KAJtBuB,I;AAsDT,eAAeA,IAAf"},"metadata":{},"sourceType":"module"}