{"ast":null,"code":"var _jsxFileName = \"/Users/kokiyamamoto/Desktop/projects/react-test/react-app/src/googlemapapi.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport React, { useEffect, useRef, ReactElement } from 'react';\nimport axios from 'axios';\nimport { useSelector, useDispatch } from 'react-redux';\nimport './googlemapapi.css';\nimport { setResults } from './redux/appSlice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst apikey = \"AIzaSyC9qsxaC4dHG0ibEr9NMKC9Ddro_jdnMk8\"; // the apikey of GoogleMap™️\n\nlet map, service, request;\nlet nearbyResults;\n\nfunction initMap(element, userLoc, radius) {\n  //mapを実際に読み込む\n  map = new window.google.maps.Map(element, {\n    center: userLoc,\n    zoom: 15\n  });\n  service = new window.google.maps.places.PlacesService(map);\n  let circle = new window.google.maps.Circle({\n    center: userLoc,\n    fillColor: '#ff0000',\n    fillOpacity: 0.2,\n    map: map,\n    radius: radius,\n    strokeColor: '#ff0000',\n    strokeOpacity: 1,\n    strokeWeight: 1\n  });\n}\n\nfunction CreateMarker(place, radius) {\n  _s();\n\n  let resultElement = useSelector(state => state.reducer.resultElement);\n  let placeLoc = place.geometry.location;\n  let marker = new window.google.maps.Marker({\n    map: map,\n    position: place.geometry.location,\n    radius: radius\n  });\n  marker.addListener(\"click\", () => {\n    autoScroll(resultElement);\n  });\n}\n\n_s(CreateMarker, \"57Q2O75fIxWefIDVFY6VMql264c=\", false, function () {\n  return [useSelector];\n});\n\n_c = CreateMarker;\n\nconst autoScroll = element => {\n  element.scrollTo(0, 100);\n};\n\nconst getPlace = request => {\n  return new Promise((resolve, reject) => {\n    const service = new window.google.maps.places.PlacesService(map);\n    service.nearbySearch(request, (results, status) => {\n      if (status === 'OK') {\n        resolve(results);\n      } else {\n        reject(status);\n      }\n    });\n  });\n};\n\nfunction MapResult() {\n  _s2();\n\n  let mapResults = useSelector(state => state.reducer.mapResults);\n  const dispatch = useDispatch();\n  let ref = useRef('');\n  dispatch(setResultElement(ref));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"resultsholder\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: ref,\n      id: \"resultwindow\",\n      children: mapResults.map((value, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"resultcard\",\n        id: `content${index}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"resulttext\",\n          children: value.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"resultvic\",\n          children: value.vicinity\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"resultrating\",\n          children: value.rating\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 25\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 51\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(MapResult, \"XJ+j66aS7HS/S1cOeJUecDaa5Lo=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c2 = MapResult;\n\nfunction resultsController(results, radius) {\n  let newResults = [];\n\n  for (let i = 0; i < results.length; i++) {\n    let newResult = {};\n\n    if (results.length <= 0) {\n      newResults.name = \"I see nothing out there ;(\";\n      newResults.push(newResult);\n      break;\n    }\n\n    let result = results[i];\n    CreateMarker(result, radius);\n\n    if (result.business_status != 'OPERATIONAL') {\n      continue;\n    }\n    /*if(result.opening_hours.open_now != true){\n        continue;\n    }*/\n\n\n    newResult.name = result.name;\n    newResult.vicinity = result.vicinity;\n    newResult.rating = result.rating;\n    newResults.push(newResult);\n  }\n\n  return newResults;\n}\n\nfunction Gmap(props) {\n  _s3();\n\n  let dispatch = useDispatch();\n  useEffect(() => {\n    initMap(document.getElementById('map'), props.userLoc, props.radius);\n    request = {\n      location: props.userLoc,\n      radius: props.radius,\n      keyword: [props.result],\n      type: 'restaurant'\n    };\n    console.log(\"gmap\");\n    getPlace(request).then(response => {\n      dispatch(setResults(resultsController(response)));\n    });\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {},\n    id: \"map\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 137,\n    columnNumber: 9\n  }, this);\n}\n\n_s3(Gmap, \"rAh3tY+Iv6hWC9AI4Dm+rCbkwNE=\", false, function () {\n  return [useDispatch];\n});\n\n_c3 = Gmap;\nexport default Gmap;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"CreateMarker\");\n$RefreshReg$(_c2, \"MapResult\");\n$RefreshReg$(_c3, \"Gmap\");","map":{"version":3,"names":["React","useEffect","useRef","ReactElement","axios","useSelector","useDispatch","setResults","apikey","map","service","request","nearbyResults","initMap","element","userLoc","radius","window","google","maps","Map","center","zoom","places","PlacesService","circle","Circle","fillColor","fillOpacity","strokeColor","strokeOpacity","strokeWeight","CreateMarker","place","resultElement","state","reducer","placeLoc","geometry","location","marker","Marker","position","addListener","autoScroll","scrollTo","getPlace","Promise","resolve","reject","nearbySearch","results","status","MapResult","mapResults","dispatch","ref","setResultElement","value","index","name","vicinity","rating","resultsController","newResults","i","length","newResult","push","result","business_status","Gmap","props","document","getElementById","keyword","type","console","log","then","response"],"sources":["/Users/kokiyamamoto/Desktop/projects/react-test/react-app/src/googlemapapi.js"],"sourcesContent":["import React, { useEffect, useRef, ReactElement } from 'react';\nimport axios from 'axios';\nimport { useSelector, useDispatch } from 'react-redux';\nimport './googlemapapi.css';\nimport { setResults } from './redux/appSlice';\n\nconst apikey = \"AIzaSyC9qsxaC4dHG0ibEr9NMKC9Ddro_jdnMk8\"; // the apikey of GoogleMap™️\nlet map, service, request;\nlet nearbyResults;\n\nfunction initMap(element, userLoc, radius) {\n    //mapを実際に読み込む\n    map = new window.google.maps.Map(element, {\n        center: userLoc,\n        zoom: 15\n    });\n    service = new window.google.maps.places.PlacesService(map);\n    \n    let circle = new window.google.maps.Circle({\n        center: userLoc,       \n        fillColor: '#ff0000',   \n        fillOpacity: 0.2,    \n        map: map,             \n        radius: radius,          \n        strokeColor: '#ff0000', \n        strokeOpacity: 1,       \n        strokeWeight: 1        \n    });\n\n}\n\nfunction CreateMarker(place, radius) {\n    let resultElement = useSelector(state => state.reducer.resultElement);\n    let placeLoc = place.geometry.location;\n    let marker = new window.google.maps.Marker({\n        map: map,\n        position: place.geometry.location,\n        radius:radius\n    });\n    marker.addListener(\"click\", () => {\n        autoScroll(resultElement);\n      });\n    \n}\n\nconst autoScroll = (element) => {\n\n    element.scrollTo(0,100);\n}\n\n\nconst getPlace = (request) => {\n    return new Promise((resolve, reject) => {\n        const service = new window.google.maps.places.PlacesService(map);\n        service.nearbySearch(request,(results,status) => {\n            if (status === 'OK') {\n                \n                resolve(results);\n            } else {\n                reject(status);\n            }    \n        });    \n    });\n};\n\nfunction MapResult(){\n\n    let mapResults = useSelector(state => state.reducer.mapResults);\n    const dispatch = useDispatch();\n    let ref = useRef('');\n    dispatch(setResultElement(ref));\n    \n    return(\n        <div id=\"resultsholder\">\n            <div ref={ref}\n                id=\"resultwindow\">\n                {mapResults.map((value, index) => <div \n                        className=\"resultcard\"\n                        key={index}\n                        id={`content${index}`}>\n                        <div className=\"resulttext\">{value.name}</div>\n                        <div className=\"resultvic\">{value.vicinity}</div>\n                        <div className=\"resultrating\">{value.rating}</div></div>)}\n            </div>\n        </div>\n    )\n}\n\nfunction resultsController(results,radius){\n    let newResults = [];\n    for (let i = 0; i < results.length; i++) {\n        let newResult = {};\n        if(results.length <= 0){\n            newResults.name = \"I see nothing out there ;(\";\n            newResults.push(newResult);\n            break;\n        }\n        let result = results[i];\n        CreateMarker(result,radius);\n        if(result.business_status != 'OPERATIONAL'){\n            continue;\n        }\n        /*if(result.opening_hours.open_now != true){\n            continue;\n        }*/\n        \n        newResult.name = result.name;\n        newResult.vicinity = result.vicinity;\n        newResult.rating = result.rating;\n        newResults.push(newResult);\n    }\n    return newResults;\n\n}\n\n\nfunction Gmap(props) {\n\n    let dispatch = useDispatch();\n    useEffect(() => {\n\n        initMap(document.getElementById('map'), props.userLoc, props.radius);\n\n        request = {\n            location: props.userLoc,\n            radius: props.radius,\n            keyword: [props.result],\n            type: 'restaurant',\n            \n        };\n        console.log(\"gmap\");\n        getPlace(request).then((response) => {\n           dispatch(setResults(resultsController(response)));\n        });\n    })\n    return (\n        <div style={{}} id=\"map\"></div>\n    )\n}\n\nexport default Gmap;"],"mappings":"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"},"metadata":{},"sourceType":"module"}