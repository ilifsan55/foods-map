{"ast":null,"code":"import { getServiceObject, getCenter } from './map';\nimport { doGoogleMapSearchPromise } from '../logics/map';\nimport axios from 'axios';\nimport jsonp from 'axios-jsonp';\nlet searchStatus = 'READY';\nexport const trySearch = (keyword, useGoogle, useHotPepper) => {\n  return new Promise((resolve, reject) => {\n    if (searchStatus !== 'READY') {\n      throw new Error('trySearch:BUSY');\n    }\n\n    searchStatus = 'BUSY';\n    console.log(keyword + ':search start');\n    let responseHotPepper;\n    let responseGoogle;\n    let promiseGoogle;\n    let promiseHotPepper;\n    const req = {\n      keyword: keyword,\n      radius: 500,\n      userLoc: getCenter()\n    };\n\n    if (!useGoogle && !useHotPepper) {\n      searchStatus = 'READY';\n      return;\n    }\n\n    if (useHotPepper) {\n      promiseHotPepper = axios.get(createHotPepperRequest(req), {\n        adapter: jsonp\n      }).then(response => {\n        responseHotPepper = perseHotPepperResults(response);\n      });\n    }\n\n    if (useGoogle) {\n      promiseGoogle = doGoogleMapSearchPromise(createGoogleRequest(req), getServiceObject()).then(response => {\n        responseGoogle = perseGoogleResults(response);\n      }).catch(status => {\n        responseGoogle = perseGoogleResults(status);\n      });\n    }\n\n    Promise.all([promiseGoogle, promiseHotPepper]).then(message => {\n      if (!useGoogle) responseGoogle = 'NO_RESULTS';\n      if (!useHotPepper) responseHotPepper = 'NO_RESULTS';\n      let res = combineResults(responseGoogle, responseHotPepper, req.userLoc);\n      resolve(res);\n    });\n  });\n};\nexport function createGoogleRequest(req) {\n  let request = {\n    location: req.userLoc,\n    radius: req.radius,\n    keyword: req.keyword,\n    language: 'ja',\n    type: 'restaurant' //only one type can be specified at once!! should i consider adding the other types like cafe and etcetc?? this can be achived by simply running the another search and add up results\n\n  };\n  return request;\n}\nexport function createHotPepperRequest(req) {\n  let apiKeyHotPepper = '1ff50644037f0f38';\n  let lat = req.userLoc.lat();\n  let lng = req.userLoc.lng();\n  let keyword = req.keyword;\n  const apiURL = `https://webservice.recruit.co.jp/hotpepper/gourmet/v1/?key=${apiKeyHotPepper}&lat=${lat}&lng=${lng}&count=100&range=3&keyword=${keyword}&order=4&format=jsonp`;\n  return apiURL;\n}\n\nfunction similarity(str1, str2) {\n  let longer = str1;\n  let shorter = str2;\n\n  if (str1.length < str2.length) {\n    longer = str2;\n    shorter = str1;\n  }\n\n  var longerLength = longer.length;\n\n  if (longerLength == 0) {\n    return 1.0;\n  }\n\n  return (longerLength - editDistance(longer, shorter)) / parseFloat(longerLength);\n}\n\nfunction editDistance(str1, str2) {\n  let costs = [];\n\n  for (let i = 0; i <= str1.length; i++) {\n    let lastValue = i;\n\n    for (let j = 0; j <= str2.length; j++) {\n      if (i == 0) costs[j] = j;else {\n        if (j > 0) {\n          let newValue = costs[j - 1];\n          if (str1.charAt(i - 1) != str2.charAt(j - 1)) newValue = Math.min(Math.min(newValue, lastValue), costs[j]) + 1;\n          costs[j - 1] = lastValue;\n          lastValue = newValue;\n        }\n      }\n    }\n\n    if (i > 0) costs[str2.length] = lastValue;\n  }\n\n  return costs[str2.length];\n}\n\nexport function combineResults(res1, res2, loc) {\n  let results, status;\n  let itemsShouldbeSpliced = [];\n  let itemsShouldbeUnShifted = [];\n\n  if (res1 === 'NO_RESULTS' && res2 === 'NO_RESULTS') {\n    status = 'NO_RESULTS';\n    results = [];\n  } else if (res2 === 'NO_RESULTS') {\n    status = 'DONE';\n    results = res1;\n  } else if (res1 === 'NO_RESULTS') {\n    status = 'DONE';\n    results = res2;\n  } else {\n    for (let i = 0; i < res1.length; i++) {\n      for (let j = 0; j < res2.length; j++) {\n        let sim = similarity(res1[i].name, res2[j].name);\n\n        if (sim > 0.5) {\n          res1[i].hotpepper = res2[j].hotpepper;\n          itemsShouldbeSpliced.push(j);\n          itemsShouldbeUnShifted.push(i);\n          console.log(\"detected\");\n        }\n      }\n    }\n\n    status = 'DONE';\n\n    for (let i = 0; i < itemsShouldbeSpliced.length; i++) {\n      res2.splice(itemsShouldbeSpliced[i], 1);\n    }\n    /*for (let i = 0; i < itemsShouldbeUnShifted.length; i++) {\n         res1.unshift(res1[itemsShouldbeUnShifted[i]]);\n         res1.splice(itemsShouldbeUnShifted[i+1], 1);\n    }*/\n\n\n    results = res1.concat(res2);\n  }\n\n  let res = {\n    status: status,\n    results: results,\n    lat: loc.lat(),\n    lng: loc.lng()\n  };\n  searchStatus = 'WAITING';\n  let timeout = setTimeout(() => {\n    searchStatus = 'READY';\n  }, 3000);\n  console.log(res);\n  return res;\n}\nexport function perseGoogleResults(results) {\n  let result_temp = {};\n  let parsedResults = [];\n\n  if (results === 'ZERO_RESULTS') {\n    return 'NO_RESULTS';\n  }\n\n  for (let i = 0; i < results.length; i++) {\n    let result = results[i];\n    result_temp = {};\n    result_temp.name = result.name;\n    result_temp.vicinity = result.vicinity;\n    result_temp.rating = result.rating;\n    result_temp.lat = result.geometry.location.lat();\n    result_temp.lng = result.geometry.location.lng();\n    result_temp.type = 1;\n    result_temp.rat = result.user_ratings_total;\n    result_temp.google = 'we_are_still_working_on_it.sry';\n    result_temp.photo = result.photos[0].getUrl();\n    /*axios.get(`https://maps.googleapis.com/maps/api/place/details/json?place_id=${result.place_id}&key=AIzaSyC9qsxaC4dHG0ibEr9NMKC9Ddro_jdnMk8`, {\n        adapter: jsonp\n    }).then((response) => {\n         console.log(response);\n        result_temp.google = response.url;\n     });*/\n    //cors error occurs\n\n    parsedResults.push(result_temp);\n  }\n\n  return parsedResults;\n}\nexport function perseHotPepperResults(res) {\n  let result_temp = {};\n  let parsedResults = [];\n  let results = res.data.results.shop;\n\n  if (res.data.results.shop.length <= 0) {\n    return 'NO_RESULTS';\n  }\n\n  for (let i = 0; i < results.length; i++) {\n    let result = results[i];\n    result_temp = {};\n    result_temp.name = result.name;\n    result_temp.vicinity = result.address;\n    result_temp.rating = 5;\n    result_temp.lat = result.lat;\n    result_temp.lng = result.lng;\n    result_temp.type = 2;\n    result_temp.photo = result.photo.mobile.l;\n    result_temp.hotpepper = `hotpepper.jp/str${result.id}`;\n    parsedResults.push(result_temp);\n  }\n\n  return parsedResults;\n}","map":{"version":3,"names":["getServiceObject","getCenter","doGoogleMapSearchPromise","axios","jsonp","searchStatus","trySearch","keyword","useGoogle","useHotPepper","Promise","resolve","reject","Error","console","log","responseHotPepper","responseGoogle","promiseGoogle","promiseHotPepper","req","radius","userLoc","get","createHotPepperRequest","adapter","then","response","perseHotPepperResults","createGoogleRequest","perseGoogleResults","catch","status","all","message","res","combineResults","request","location","language","type","apiKeyHotPepper","lat","lng","apiURL","similarity","str1","str2","longer","shorter","length","longerLength","editDistance","parseFloat","costs","i","lastValue","j","newValue","charAt","Math","min","res1","res2","loc","results","itemsShouldbeSpliced","itemsShouldbeUnShifted","sim","name","hotpepper","push","splice","concat","timeout","setTimeout","result_temp","parsedResults","result","vicinity","rating","geometry","rat","user_ratings_total","google","photo","photos","getUrl","data","shop","address","mobile","l","id"],"sources":["/Users/kokiyamamoto/Desktop/projects/FoodsMap/src/components/logics/search.js"],"sourcesContent":["\nimport {getServiceObject, getCenter} from './map';\nimport {doGoogleMapSearchPromise} from '../logics/map';\nimport axios from 'axios';\nimport jsonp from 'axios-jsonp';\nlet searchStatus = 'READY';\nexport const trySearch = (keyword, useGoogle, useHotPepper) => {\n    return new Promise((resolve, reject) => {\n        if (searchStatus !== 'READY') {\n            throw new Error('trySearch:BUSY');\n        }\n        searchStatus = 'BUSY';\n        console.log(keyword + ':search start');\n        let responseHotPepper;\n        let responseGoogle;\n        let promiseGoogle;\n        let promiseHotPepper;\n        const req = {\n            keyword: keyword,\n            radius: 500,\n            userLoc: getCenter(),\n        };\n        if (!useGoogle && !useHotPepper) {\n            searchStatus = 'READY';\n            return;\n        }\n        if (useHotPepper) {\n            promiseHotPepper = axios.get(createHotPepperRequest(req), {\n                adapter: jsonp\n            }).then((response) => {\n                responseHotPepper = perseHotPepperResults(response);\n            });\n        }\n        if (useGoogle){\n            promiseGoogle = doGoogleMapSearchPromise(createGoogleRequest(req), getServiceObject()).then((response) => {\n                responseGoogle = perseGoogleResults(response);\n            }).catch((status) => {\n                responseGoogle = perseGoogleResults(status);\n            })\n        }\n        Promise.all([promiseGoogle, promiseHotPepper]).then((message) => {\n            if (!useGoogle)\n                responseGoogle = 'NO_RESULTS';\n            if (!useHotPepper)\n                responseHotPepper = 'NO_RESULTS';\n            let res = combineResults(responseGoogle, responseHotPepper, req.userLoc);\n            resolve(res);\n        })\n    })\n}\nexport function createGoogleRequest(req) {\n    let request = {\n        location: req.userLoc,\n        radius: req.radius,\n        keyword: req.keyword,\n        language: 'ja',\n        type: 'restaurant',//only one type can be specified at once!! should i consider adding the other types like cafe and etcetc?? this can be achived by simply running the another search and add up results\n    };\n    return request;\n}\nexport function createHotPepperRequest(req) {\n\n    let apiKeyHotPepper = '1ff50644037f0f38';\n    let lat = req.userLoc.lat();\n    let lng = req.userLoc.lng();\n    let keyword = req.keyword;\n    const apiURL = `https://webservice.recruit.co.jp/hotpepper/gourmet/v1/?key=${apiKeyHotPepper}&lat=${lat}&lng=${lng}&count=100&range=3&keyword=${keyword}&order=4&format=jsonp`;\n\n    return apiURL;\n}\n\nfunction similarity(str1, str2) {\n    let longer = str1;\n    let shorter = str2;\n    if (str1.length < str2.length) {\n        longer = str2;\n        shorter = str1;\n    }\n    var longerLength = longer.length;\n    if (longerLength == 0) {\n        return 1.0;\n    }\n    return (longerLength - editDistance(longer, shorter)) / parseFloat(longerLength);\n}\n\nfunction editDistance(str1, str2) {\n\n    let costs = [];\n    for (let i = 0; i <= str1.length; i++) {\n        let lastValue = i;\n        for (let j = 0; j <= str2.length; j++) {\n            if (i == 0)\n                costs[j] = j;\n            else {\n                if (j > 0) {\n                    let newValue = costs[j - 1];\n                    if (str1.charAt(i - 1) != str2.charAt(j - 1))\n                        newValue = Math.min(Math.min(newValue, lastValue),\n                            costs[j]) + 1;\n                    costs[j - 1] = lastValue;\n                    lastValue = newValue;\n                }\n            }\n        }\n        if (i > 0)\n            costs[str2.length] = lastValue;\n    }\n    return costs[str2.length];\n}\n\nexport function combineResults(res1, res2, loc) {\n\n    let results, status;\n    let itemsShouldbeSpliced = [];\n\n    let itemsShouldbeUnShifted = [];\n\n    if (res1 === 'NO_RESULTS' && res2 === 'NO_RESULTS') {\n        status = 'NO_RESULTS';\n        results = [];\n    } else if (res2 === 'NO_RESULTS') {\n        status = 'DONE';\n        results = res1;\n    } else if (res1 === 'NO_RESULTS') {\n        status = 'DONE';\n        results = res2;\n    } else {\n        for (let i = 0; i < res1.length; i++) {\n            for (let j = 0; j < res2.length; j++) {\n                let sim = similarity(res1[i].name, res2[j].name);\n                if (sim > 0.5) {\n                    res1[i].hotpepper = res2[j].hotpepper;\n                    itemsShouldbeSpliced.push(j);\n                    itemsShouldbeUnShifted.push(i);\n                    console.log(\"detected\");\n                }\n            }\n        }\n\n        status = 'DONE';\n        for (let i = 0; i < itemsShouldbeSpliced.length; i++) {\n\n            res2.splice(itemsShouldbeSpliced[i], 1);\n        }\n        /*for (let i = 0; i < itemsShouldbeUnShifted.length; i++) {\n\n            res1.unshift(res1[itemsShouldbeUnShifted[i]]);\n\n            res1.splice(itemsShouldbeUnShifted[i+1], 1);\n        }*/\n        results = res1.concat(res2);\n    }\n\n    let res = {\n        status: status,\n        results: results,\n        lat: loc.lat(),\n        lng: loc.lng()\n    }\n    searchStatus = 'WAITING';\n    let timeout = setTimeout(() => { searchStatus = 'READY' }, 3000);\n    console.log(res);\n    return res;\n\n}\n\nexport function perseGoogleResults(results) {\n\n    let result_temp = {};\n    let parsedResults = [];\n\n    if (results === 'ZERO_RESULTS') {\n\n        return 'NO_RESULTS';\n\n    }\n\n    for (let i = 0; i < results.length; i++) {\n\n        let result = results[i];\n        result_temp = {};\n        result_temp.name = result.name;\n        result_temp.vicinity = result.vicinity;\n        result_temp.rating = result.rating;\n        result_temp.lat = result.geometry.location.lat();\n        result_temp.lng = result.geometry.location.lng();\n        result_temp.type = 1;\n        result_temp.rat = result.user_ratings_total;\n        result_temp.google = 'we_are_still_working_on_it.sry';\n        result_temp.photo = result.photos[0].getUrl();\n\n        /*axios.get(`https://maps.googleapis.com/maps/api/place/details/json?place_id=${result.place_id}&key=AIzaSyC9qsxaC4dHG0ibEr9NMKC9Ddro_jdnMk8`, {\n            adapter: jsonp\n        }).then((response) => {\n\n            console.log(response);\n            result_temp.google = response.url;\n\n        });*/\n\n        //cors error occurs\n\n        parsedResults.push(result_temp);\n    }\n\n    return parsedResults;\n\n}\n\n\nexport function perseHotPepperResults(res) {\n\n    let result_temp = {};\n    let parsedResults = [];\n    let results = res.data.results.shop;\n\n    if (res.data.results.shop.length <= 0) {\n\n        return 'NO_RESULTS';\n\n    }\n\n    for (let i = 0; i < results.length; i++) {\n\n        let result = results[i];\n        result_temp = {};\n        result_temp.name = result.name;\n        result_temp.vicinity = result.address;\n        result_temp.rating = 5;\n        result_temp.lat = result.lat;\n        result_temp.lng = result.lng;\n        result_temp.type = 2;\n        result_temp.photo = result.photo.mobile.l;\n        result_temp.hotpepper = `hotpepper.jp/str${result.id}`;\n        parsedResults.push(result_temp);\n\n    }\n\n    return parsedResults;\n\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}