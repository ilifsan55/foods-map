{"ast":null,"code":"import { getServiceObject, getUserLocation, getCenter } from './map';\nimport AppSlice, { appSlice } from '../../redux/appSlice';\nimport mapSlice from '../../redux/mapSlice';\nimport wheelSlice from '../../redux/wheelSlice';\nimport { searchSlice } from '../../redux/searchSlice';\nimport { createGoogleRequest, combineResults, doGoogleMapSearchPromise, perseGoogleResults, perseHotPepperResults, createHotPepperRequest } from '../logics/map';\nimport axios from 'axios';\nimport jsonp from 'axios-jsonp';\nexport const trySearch = (keyword, useGoogle, useHotPepper) => {\n  let responseHotPepper, responseGoogle, promise1, promise2;\n  let req = {\n    keyword: keyword,\n    radius: 500,\n    userLoc: getCenter(),\n    useGoogle: true,\n    useHotPepper: true,\n    useGurunabi: true,\n    isDone: false\n  };\n\n  if (useHotPepper) {\n    promise1 = axios.get(createHotPepperRequest(req), {\n      adapter: jsonp\n    }).then(response => {\n      responseHotPepper = perseHotPepperResults(response);\n    });\n  }\n\n  if (useGoogle) {\n    promise2 = doGoogleMapSearchPromise(createGoogleRequest(req), getServiceObject()).then(response => {\n      responseGoogle = perseGoogleResults(response);\n    }).catch(status => {\n      responseGoogle = perseGoogleResults(status);\n    });\n  }\n\n  if (promise1 == undefined && promise2 == undefined) return;\n  Promise.all([promise1, promise2]).then(message => {\n    console.log(promise1);\n    console.log(responseHotPepper);\n\n    if (responseGoogle == 'NO_RESULTS' || responseGoogle == undefined || promise1 == undefined) {\n      if (responseHotPepper == 'NO_RESULTS' || responseHotPepper == undefined || promise2 == undefined) {\n        dispatch(mapSlice.actions.setSearchResults([]));\n        dispatch(mapSlice.actions.setSearchStatus('NO_RESULTS'));\n      } else {\n        dispatch(mapSlice.actions.setSearchResults(responseHotPepper));\n        dispatch(mapSlice.actions.setSearchStatus('DO３２NE'));\n      }\n    } else {\n      if (responseHotPepper == 'NO_RESULTS' || responseHotPepper == undefined || promise2 == undefined) {\n        dispatch(mapSlice.actions.setSearchResults(responseGoogle));\n        dispatch(mapSlice.actions.setSearchStatus('DO１１１NE'));\n      } else {\n        let combinedResults = combineResults(responseGoogle, responseHotPepper);\n        dispatch(mapSlice.actions.setSearchResults(combinedResults));\n        dispatch(mapSlice.actions.setSearchStatus('DsONE'));\n      }\n    }\n  });\n};","map":{"version":3,"names":["getServiceObject","getUserLocation","getCenter","AppSlice","appSlice","mapSlice","wheelSlice","searchSlice","createGoogleRequest","combineResults","doGoogleMapSearchPromise","perseGoogleResults","perseHotPepperResults","createHotPepperRequest","axios","jsonp","trySearch","keyword","useGoogle","useHotPepper","responseHotPepper","responseGoogle","promise1","promise2","req","radius","userLoc","useGurunabi","isDone","get","adapter","then","response","catch","status","undefined","Promise","all","message","console","log","dispatch","actions","setSearchResults","setSearchStatus","combinedResults"],"sources":["/Users/kokiyamamoto/Desktop/projects/FoodsMap/src/components/logics/search.js"],"sourcesContent":["\nimport { getServiceObject, getUserLocation, getCenter } from './map';\nimport AppSlice, { appSlice } from '../../redux/appSlice';\nimport mapSlice from '../../redux/mapSlice';\nimport wheelSlice from '../../redux/wheelSlice';\nimport { searchSlice } from '../../redux/searchSlice';\nimport { createGoogleRequest, combineResults, doGoogleMapSearchPromise, perseGoogleResults, perseHotPepperResults, createHotPepperRequest } from '../logics/map';\n\nimport axios from 'axios'\nimport jsonp from 'axios-jsonp'\n\nexport const trySearch = (keyword,useGoogle,useHotPepper) => {\n\n    let responseHotPepper, responseGoogle, promise1, promise2;\n\n    let req = {\n      keyword: keyword,\n      radius: 500,\n      userLoc: getCenter(),\n      useGoogle: true,\n      useHotPepper: true,\n      useGurunabi: true,\n      isDone: false,\n    };\n\n    if (useHotPepper) {\n\n      promise1 = axios.get(createHotPepperRequest(req), {\n        adapter: jsonp\n      }).then((response) => {\n\n        responseHotPepper = perseHotPepperResults(response);\n\n      });\n    }\n    if (useGoogle) {\n\n      promise2 = doGoogleMapSearchPromise(createGoogleRequest(req), getServiceObject()).then((response) => {\n\n\n        responseGoogle = perseGoogleResults(response);\n\n\n\n      }).catch((status) => {\n        responseGoogle = perseGoogleResults(status);\n\n      })\n    }\n    if (promise1 == undefined && promise2 == undefined)\n      return;\n\n\n    Promise.all([promise1, promise2]).then((message) => {\n      console.log(promise1);\n      console.log(responseHotPepper);\n\n      if (responseGoogle == 'NO_RESULTS' || responseGoogle == undefined || promise1 == undefined) {\n        if (responseHotPepper == 'NO_RESULTS' || responseHotPepper == undefined || promise2 == undefined) {\n\n          dispatch(mapSlice.actions.setSearchResults([]));\n          dispatch(mapSlice.actions.setSearchStatus('NO_RESULTS'));\n        } else {\n\n\n          dispatch(mapSlice.actions.setSearchResults(responseHotPepper));\n\n          dispatch(mapSlice.actions.setSearchStatus('DO３２NE'));\n        }\n\n      } else {\n        if (responseHotPepper == 'NO_RESULTS' || responseHotPepper == undefined || promise2 == undefined) {\n\n\n          dispatch(mapSlice.actions.setSearchResults(responseGoogle));\n\n          dispatch(mapSlice.actions.setSearchStatus('DO１１１NE'));\n        } else {\n\n\n          let combinedResults = combineResults(responseGoogle, responseHotPepper);\n\n          dispatch(mapSlice.actions.setSearchResults(combinedResults));\n\n          dispatch(mapSlice.actions.setSearchStatus('DsONE'));\n        }\n\n\n      }\n\n\n\n\n    })};"],"mappings":"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"},"metadata":{},"sourceType":"module"}